(self.webpackChunkgatsby_test=self.webpackChunkgatsby_test||[]).push([[612],{22019:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var i=n(85061),r=n(18446),a=n.n(r),s=n(37107),o=function(){function e(e,t){this.testConstructorInputPreconditions(e,t),this.DataProvider=e,this.InitialTrainingObject=t;var n=t.classifierType,i=t.featuresToUse,r=t.trainingData,a=t.trainingLabels;this.TrainingSetObject={classifierType:n,featuresToUse:i,trainingData:r,trainingLabels:a},this.Classifier=new s.q(this.TrainingSetObject)}var t=e.prototype;return t.testConstructorInputPreconditions=function(e,t){if(null==e||null==t)throw new Error("Constructor Error on no dataprovider or no initialtrainingobject");if(void 0===t.trainingData||void 0===t.trainingLabels||void 0===t.featuresToUse||void 0===t.classifierType)throw new Error("Constructor Error on InitialTrainingData missing fields");if("LogisticRegression"!==t.classifierType)throw new Error("Constructor Error classifierType passed in is not implemented")},t.initTrainPromise=function(){return this.Classifier.trainPromise()},t.fetchUpToNCellPairsByClass=function(e,t){var n=this;if("positive"!==e&&"negative"!==e&&"random"!==e)throw new Error("Error on invalid class: got "+e+" but expected negative or positive or random}");var i=this.DataProvider.getNRandomObjs(t);if("random"===e)return i;var r=i.map((function(e){return n.DataProvider.getRow("object_data",e)})),a=0;"positive"==e&&(a=1);var s=this.Classifier.predict(r);return i.filter((function(e,t){return s[t]===a}))},t.appendToTrainingSetAndRetrainPromise=function(e){if(this.TrainingSetObject.trainingData=[].concat((0,i.Z)(this.TrainingSetObject.trainingData),(0,i.Z)(e.trainingData)),this.TrainingSetObject.trainingLabels=[].concat((0,i.Z)(this.TrainingSetObject.trainingLabels),(0,i.Z)(e.trainingLabels)),this.TrainingSetObject.classifierType!==e.classifierType||!a()(this.TrainingSetObject.featuresToUse,e.featuresToUse))throw new Error("Error incompatible addition TrainingSetObject, needs same classifierType and featuresToUse:\nComparison: expected: "+this.TrainingSetObject.classifierType+" and "+this.TrainingSetObject.featuresToUse+"\ngot: "+e.classifierType+" and "+e.featuresToUse);return this.Classifier=new s.q(this.TrainingSetObject),this.Classifier.trainPromise()},t.getTrainingSetObject=function(){return this.TrainingSetObject},t.userDownloadClassifierSpecPromise=function(){return this.Classifier.DownloadModelPromise()},e}()},49224:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var i=n(92137),r=n(87757),a=n.n(r),s=n(6750),o=n(13967),l=function(){function e(e,t){this.getObjsToURLs=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,o,l,c,u,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],i=0;case 2:if(!(i<t.length)){e.next=19;break}return r=t[i].ImageNumber,o=[],l=r.toString(),e.next=8,this.getImagefromFile(r);case 8:return o=e.sent,this.images_seen[l]=o,c=this.data_provider.getCordsforCellDisplay(t[i]),u=new s.F(o,c),e.next=14,u.getDataURL();case 14:m=e.sent,n.push(m);case 16:i++,e.next=2;break;case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),this.getImgUrl=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getImagesfromFile(t),i=new s.F(n),e.abrupt("return",i.getDataUrl());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),this.getImagefromFile=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n=this.data_provider.returnAllImgFileNames(t),e.next=4,Promise.all(n.map((function(e){var t=s.file_handler.findFile(e.filename);return s.file_handler.fileReaderPromiseImage(t).then((function(e){return s.makeImage(e)}))})));case 4:for(i=e.sent,[],r=0;r<i.length;r++)delete n.filename,n[r].image=i[r];return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),this.file_handler=new o.Z(e),this.data_provider=t,this.images_seen={}}return e.prototype.makeImage=function(e){var t=new Image;return t.src=e,t},e}()},6750:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var i=function(){function e(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n={}),void 0===i&&(i="object"),this.img_info=e,this.box_dim=n,this.image_type=i,this.cords=t,this.canvases={}}var t=e.prototype;return t.setDimensionsofImg=function(){"object"===this.image_type&&(this.box_dim.h=40,this.box_dim.l=40),"image"===this.image_type&&(this.box_dim.l=this.img_info[0].image.width,this.box_dim.h=this.img_info[0].image.height)},t.getDataURL=function(){this.setDimensionsofImg();var e=document.createElement("canvas");e.width=this.img_info[0].image.width,e.height=this.img_info[0].image.height;for(var t=e.getContext("2d"),n=0;n<this.img_info.length;n++){var i=this.img_info[n].color,r=document.createElement("canvas");this.canvases[i]=r}for(n=0;n<this.img_info.length;n++){i=this.img_info[n].color.toString();this.createColorCanvas(this.img_info[n].image,i)}t.globalCompositeOperation="lighter";for(n=0;n<this.img_info.length;n++){var a=this.img_info[n];t.drawImage(this.canvases[a.color],this.cords.x,this.cords.y,this.box_dim.h,this.box_dim.l,0,0,e.width,e.height)}return t.globalCompositeOperation="source-over",e.toDataURL()},t.createColorCanvas=function(e,t){var n=e.height,i=e.width;this.canvases[t].width=i,this.canvases[t].height=n;var r=this.canvases[t].getContext("2d");r.globalCompositeOperation="source-over",r.drawImage(e,0,0),r.globalCompositeOperation="multiply",r.fillStyle=t,r.fillRect(0,0,i,n),r.globalCompositeOperation="source-over"},e}()},39331:function(e,t,n){"use strict";n.d(t,{e:function(){return a}});var i=n(64721),r=n.n(i),a=function(){function e(e,t){if(this.classifications=[],!e||!t)throw new Error("Constructor Error on no data url or data pairs passed in");if(e.length!==t.length)throw new Error("Constructor Error on mismatched data pair and dataurl length");this.data_pairs=e,this.dataurls=t;for(var n=0;n<this.data_pairs.length;n++)this.classifications.push("unclassified")}e.getDataUrlFromImg=function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),i=new Image;return i.onload=function(){n.drawImage(i,0,0)},i.src=e,i.crossOrigin="Anonymous",t.toDataURL()};var t=e.prototype;return t.getNumberImages=function(){return this.data_pairs.length},t.getDataUrlByIndex=function(e){return this.dataurls[e]},t.setImageClassByIndex=function(e,t){if(void 0===e||void 0===t)throw new Error("setImageClassByIndex Error must have 2 arguments: index and class");if(!r()(["unclassified","positive","negative"],t))throw new Error("setImageClassByIndex Error incorrect class to set: "+t+", must be: unclassified, positive, negative");this.classifications[e]=t},t.getAllIndexes=function(e,t){for(var n=[],i=-1;-1!=(i=e.indexOf(t,i+1));)n.push(i);return n},t.getPairsByClass=function(e){if(r()(["unclassified","positive","negative"],e)){for(var t=[],n=this.getAllIndexes(this.classifications,e),i=0;i<n.length;i++)t.push(this.data_pairs[n[i]]);return t}throw new Error("wrong class entered")},t.setClassByIndexArray=function(e,t){if(!r()(["unclassified","positive","negative"],e))throw new Error("wrong class entered");for(var n=0;n<t.length;n++)this.classifications[t[n]]=e},e}()},68127:function(e,t,n){"use strict";n.r(t);var i=n(85061),r=n(92137),a=n(87757),s=n.n(a),o=n(67294),l=n(96667),c=n(47798),u=n(83332),m=n(80838),g=n(44005),d=n(90058),f=n(43638),h=n(80633),p=n(79312),v=n(85505),b=n(10920),w=n(27136),E=n(51474),y=n(49995),Z=n(13508),x=n(54657),C=n(98910),T=n(22019),S=n(49224),I=n(39331),k=n(4513),_=n(89952),N=n(65733),j=n(32253),O=n(9901),P=n(31690),D=n(11592),L=n(76047),R=n(77447),U=n(60577),B=n(29181),H=n(55610),A=n(88816),F=n(59477),z=n(59274),W=n(31261),$=n(8441),M=n(96531),q=n(48498),V=(n(34058),n(74298),o.forwardRef((function(e,t){return o.createElement(U.Z,Object.assign({direction:"up",ref:t},e))}))),X=(0,b.Z)((function(e){return{root:{display:"flex",alignItems:"center"},wrapper:{margin:e.spacing(1),position:"relative"},buttonSuccess:{backgroundColor:E.Z[500],"&:hover":{backgroundColor:E.Z[700]}},fabProgress:{color:E.Z[500],position:"absolute",top:-6,left:-6,zIndex:1},buttonProgress:{color:E.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));t.default=function(){var e,t,n=o.useState(null),a=n[0],b=n[1],E=o.useState(null),U=E[0],G=E[1],J=o.useState(null),K=J[0],Q=J[1],Y=o.useState(null),ee=Y[0],te=Y[1],ne=o.useState(rt([])),ie=ne[0],re=ne[1],ae=o.useState(null),se=ae[0],oe=ae[1],le=o.useState(null),ce=(le[0],le[1]),ue=o.useState(null),me=ue[0],ge=ue[1],de=o.useState(!1),fe=de[0],he=de[1],pe=o.useState(!1),ve=pe[0],be=pe[1],we=o.useState(!1),Ee=we[0],ye=we[1],Ze=o.useState(!1),xe=Ze[0],Ce=Ze[1],Te=o.useState(!0),Se=Te[0],Ie=Te[1],ke=o.useState(!1),_e=(ke[0],ke[1]),Ne=o.useState(!1),je=Ne[0],Oe=Ne[1],Pe=o.useState(!1),De=Pe[0],Le=Pe[1],Re=o.useState(!1),Ue=Re[0],Be=Re[1],He=o.useState(!1),Ae=He[0],Fe=He[1],ze=o.useState(!1),We=(ze[0],ze[1]),$e=o.useState(!1),Me=$e[0],qe=$e[1],Ve=function(){We(!0)},Xe=function(){qe(!1)},Ge=X(),Je=(0,v.Z)(((e={})[Ge.buttonSuccess]=De,e)),Ke=function(e){b(null),void 0!==e&&et(e)},Qe=function(){he(!1),be(!1),Ce(!1),ye(!1),_e(!1)},Ye=function(){he(!0),be(!0),Ce(!0),ye(!0),_e(!0)},et=function(){var e=(0,r.Z)(s().mark((function e(t){var n,i,r,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Be(!0),Qe(),re({unclassified:[],positive:[],negative:[]}),n=new T.$(U,K),e.next=7,n.initTrainPromise();case 7:return ce(t),i=n.fetchUpToNCellPairsByClass(t,20),r=new S.z(ee,U),e.next=12,r.getObjsToURLs(i);case 12:return a=e.sent,o=rt(a),re(o),oe(new I.e(i,a)),Ye(),oe(i,a),Ye(),Be(!1),e.abrupt("return");case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tt=function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r,a,o,l,c,u,m,g,d,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qe(),t=ie.negative.map((function(e){return e.id})),n=ie.positive.map((function(e){return e.id})),console.log(t,ie),se.setClassByIndexArray("negative",t),se.setClassByIndexArray("positive",n),r=se.getPairsByClass("negative"),a=se.getPairsByClass("positive"),o=r.map((function(e){return U.getRow("object_data",{ImageNumber:e.ImageNumber,ObjectNumber:e.ObjectNumber})})),l=a.map((function(e){return U.getRow("object_data",{ImageNumber:e.ImageNumber,ObjectNumber:e.ObjectNumber})})),c=[].concat((0,i.Z)(o),(0,i.Z)(l)),u=new Array(o.length).fill(0),m=new Array(l.length).fill(1),g=u.concat(m),d={classifierType:"LogisticRegression",trainingData:[].concat((0,i.Z)(c),(0,i.Z)(K.trainingData)),trainingLabels:[].concat((0,i.Z)(g),(0,i.Z)(K.trainingLabels)),featuresToUse:me},console.log(d),Q(d),f={unclassified:ie.unclassified,positive:[],negative:[]},re(f),console.log("finished train"),Ye();case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),nt=function(){var e=(0,r.Z)(s().mark((function e(t){var n,i,r,a,o,l,c,u,m,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Oe(!0),Ie(!1),te(t),n=new C.Z(t),e.next=6,n.getDataHandlerandStartingTrainingSet();case 6:i=e.sent,r=i.data_provider,G(r),a=i.training_data.training_table,o=a.getDataColumnsPaired(),l=a.getTrainingLabels(),c=o.map((function(e){var t=e.objectnum,n=e.imagenum;return r.getRow("object_data",{ObjectNumber:t,ImageNumber:n})})),u=i.training_data.features,m=u.filter((function(e){return!e.includes("Location")&&"ObjectNumber"!==e&&"ImageNumber"!==e})),ge(m),console.log("finished data initialization"),Q(g={classifierType:"LogisticRegression",trainingData:c,trainingLabels:l,featuresToUse:m}),he(!0),be(!0),Ce(!0),ye(!0),console.log("finished upload"),Q(g),he(!0),be(!0),Ce(!0),_e(!0),ye(!0),Ie(!1),console.log("finished upload"),Oe(!1),Le(!0);case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=(0,r.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qe(),t=new T.$(U,K),e.next=4,t.initTrainPromise();case 4:t.userDownloadClassifierSpecPromise(),Ye();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function rt(e,t){return{unclassified:e.map((function(e,t){return{id:t,address:e,info:"cellToolTips[idx]"}})),positive:[],negative:[]}}var at=function(){Fe(!1)};return o.createElement($.d,{onChange:function(e,t,n,i){var r;if(i){var a,s=(0,z.p)(ie[e],ie[i],t,n);return re(Object.assign({},ie,((a={})[e]=s[0],a[i]=s[1],a)))}var o=(0,W.L)(ie[e],t,n);return re(Object.assign({},ie,((r={})[e]=o,r)))}},o.createElement("div",{style:{overflowX:"hidden",hieght:"100%",width:"100%"}},o.createElement(l.Z,null,o.createElement(h.Z,{src:f.Z,style:{marginLeft:"10%",height:"30%",width:"25%",position:"relative",maxHeight:"125px",marginBottom:"1%"}}),o.createElement(c.Z,{style:{left:"40%"}},o.createElement("div",{className:Ge.root},o.createElement("div",{className:Ge.wrapper},o.createElement(R.ZP,{title:"Load Data","aria-label":"load data"},o.createElement(y.Z,{"aria-label":"save",color:"primary",component:"label",className:Je,style:{height:"5vw",width:"5vw"}},De?o.createElement(Z.Z,{style:{hieght:"50%",width:"50%"}}):o.createElement(x.Z,{style:{hieght:"50%",width:"50%"}}),o.createElement("input",{type:"file",hidden:!0,webkitdirectory:"true",mozdirectory:"true",msdirectory:"true",odirectory:"true",directory:"true",multiple:!0,onChange:function(e){nt(e)},disabled:!Se}))),je&&o.createElement(w.Z,{className:Ge.fabProgress,style:{height:"6vw",width:"6vw",marginTop:"4%",marginRight:"4%"}})))),o.createElement(c.Z,{style:{left:"15%",marginTop:".75%"}},o.createElement(R.ZP,{title:"Download","aria-label":"download"},o.createElement(y.Z,{"aria-label":"save",color:"primary",component:"label",disabled:!xe,onClick:it,style:{height:"5vw",width:"5vw"}}," ",o.createElement(p.Z,{style:{hieght:"50%",width:"50%"}}))))),o.createElement(l.Z,null,o.createElement(m.Z,{container:!0,justify:"center",spacing:2,style:{marginBottom:15}},o.createElement(m.Z,{key:0,item:!0},o.createElement(u.Z,{disabled:!fe,variant:"contained","aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){b(e.currentTarget)}},"Fetch"),o.createElement(g.Z,{id:"simple-menu",anchorEl:a,keepMounted:!0,open:Boolean(a),onClose:function(){b(null)}},o.createElement(d.Z,{onClick:function(){return Ke("random")}},"Random"),o.createElement(d.Z,{onClick:function(){return Ke("positive")}},"Positive"),o.createElement(d.Z,{onClick:function(){return Ke("negative")}},"Negative"),o.createElement(d.Z,{onClick:function(){Fe(!0)}},"By Image"),o.createElement(k.Z,{open:Ae,onClose:at},o.createElement(O.Z,null,"Fetch By Image"),o.createElement(N.Z,null,o.createElement(j.Z,null,"Select the image number you would like to fetch from."),o.createElement("form",{noValidate:!0},o.createElement(P.Z,null,o.createElement(D.Z,null,"Image"),o.createElement(L.Z,{autoFocus:!0},o.createElement(d.Z,{value:"1"},"1"),o.createElement(d.Z,{value:"2"},"2"),o.createElement(d.Z,{value:"3"},"3"),o.createElement(d.Z,{value:"4"},"4"),o.createElement(d.Z,{value:"5"},"5"))))),o.createElement(_.Z,null,o.createElement(u.Z,{onClick:at,color:"primary"},"Close"))))),o.createElement(m.Z,{key:1,item:!0},o.createElement(u.Z,{disabled:!ve,variant:"contained",onClick:tt},"Train")),o.createElement(m.Z,{key:2,item:!0},Ee?o.createElement(A.default,null):o.createElement(u.Z,{disabled:!Ee,variant:"contained",onClick:function(){}},"Evaluate")),o.createElement(m.Z,{key:3,item:!0},Ee?o.createElement(F.default,null):o.createElement(u.Z,((t={disabled:!Ee,onClick:function(){qe(!0)},variant:"contained"}).onClick=function(){},t),"Score All"),o.createElement(k.Z,{open:Me,TransitionComponent:V,keepMounted:!0,onClose:Xe},o.createElement(B.Z,{onClick:Xe,style:{position:"absolute",right:"10px",top:"10px"}}),o.createElement(H.default,null))))),o.createElement("div",null,o.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"10%",marginBottom:"0.5%",userSelect:"none"}},"Unclassified "),o.createElement("div",null,o.createElement(M.$,{className:"dropzone ",id:"unclassified",boxesPerRow:8,rowHeight:80,style:{height:"20vw",maxHeight:200,minHeight:150,marginBottom:10,marginLeft:"10%",width:"80%"}},Ue?o.createElement(w.Z,{style:{height:"5vw",width:"5vw",marginTop:"5%",marginLeft:"45%"}}):ie.unclassified.map((function(e){return o.createElement(q.P,{className:"hoverTest",style:{height:"20vw",width:"10vw",minHeight:80,minWidth:80,maxHeight:105,maxWidth:105,padding:10},key:e.id},o.createElement(u.Z,{className:"grid-item",onClick:Ve},o.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}},o.createElement("span",{className:"hoverText"},e.info))))})))),o.createElement(l.Z,null,o.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"11%",userSelect:"none",marginBottom:"0.5%",marginTop:0}},"Positive"),o.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingRight:"8%",userSelect:"none",margin:"auto",marginBottom:"0.5%",marginTop:0}},"Negative")),o.createElement(l.Z,null,o.createElement(M.$,{className:"dropzone positive",id:"positive",boxesPerRow:4,rowHeight:80,style:{height:"20vw",maxHeight:200,minHeight:150}},ie.positive.map((function(e){return o.createElement(q.P,{className:"hoverTest",style:{height:"50vw",width:"10vw",minHeight:80,minWidth:80,maxHeight:205,maxWidth:105,padding:10},key:e.id},o.createElement("div",{className:"grid-item"},o.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}},o.createElement("span",{className:"hoverText"},e.info))))}))),o.createElement(M.$,{className:"dropzone negative",id:"negative",boxesPerRow:4,rowHeight:80,style:{height:"20vw",maxHeight:200,minHeight:150}},ie.negative.map((function(e){return o.createElement(q.P,{className:"hoverTest",style:{height:"10vw",width:"10vw",minHeight:80,minWidth:80,maxHeight:105,maxWidth:105,padding:10},key:e.address},o.createElement("div",{className:"grid-item"},o.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}},o.createElement("span",{className:"hoverText"},e.info))))})))))))}},47415:function(e,t,n){var i=n(29932);e.exports=function(e,t){return i(t,(function(t){return e[t]}))}},64721:function(e,t,n){var i=n(42118),r=n(98612),a=n(47037),s=n(40554),o=n(52628),l=Math.max;e.exports=function(e,t,n,c){e=r(e)?e:o(e),n=n&&!c?s(n):0;var u=e.length;return n<0&&(n=l(u+n,0)),a(e)?n<=u&&e.indexOf(t,n)>-1:!!u&&i(e,t,n)>-1}},18446:function(e,t,n){var i=n(90939);e.exports=function(e,t){return i(e,t)}},47037:function(e,t,n){var i=n(44239),r=n(1469),a=n(37005);e.exports=function(e){return"string"==typeof e||!r(e)&&a(e)&&"[object String]"==i(e)}},52628:function(e,t,n){var i=n(47415),r=n(3674);e.exports=function(e){return null==e?[]:i(e,r(e))}}}]);
//# sourceMappingURL=component---src-pages-test-uimvp-js-42adcf8349b977d71a97.js.map
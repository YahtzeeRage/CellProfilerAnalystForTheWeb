(self.webpackChunkgatsby_test=self.webpackChunkgatsby_test||[]).push([[720],{49224:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var i=n(92137),r=n(87757),a=n.n(r),o=n(6750),s=n(13967),c=function(){function e(e,t){this.getObjsToURLs=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,s,c,l,u,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],i=0;case 2:if(!(i<t.length)){e.next=19;break}return r=t[i].ImageNumber,s=[],c=r.toString(),e.next=8,this.getImagefromFile(r);case 8:return s=e.sent,this.images_seen[c]=s,l=this.data_provider.getCordsforCellDisplay(t[i]),u=new o.F(s,l),e.next=14,u.getDataURL();case 14:m=e.sent,n.push(m);case 16:i++,e.next=2;break;case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),this.getImgUrl=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getImagesfromFile(t),i=new o.F(n),e.abrupt("return",i.getDataUrl());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),this.getImagefromFile=function(){var e=(0,i.Z)(a().mark((function e(t){var n,i,r,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n=this.data_provider.returnAllImgFileNames(t),e.next=4,Promise.all(n.map((function(e){var t=o.file_handler.findFile(e.filename);return o.file_handler.fileReaderPromiseImage(t).then((function(e){return o.makeImage(e)}))})));case 4:for(i=e.sent,[],r=0;r<i.length;r++)delete n.filename,n[r].image=i[r];return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),this.file_handler=new s.Z(e),this.data_provider=t,this.images_seen={}}return e.prototype.makeImage=function(e){var t=new Image;return t.src=e,t},e}()},6750:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var i=function(){function e(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n={}),void 0===i&&(i="object"),this.img_info=e,this.box_dim=n,this.image_type=i,this.cords=t,this.canvases={}}var t=e.prototype;return t.setDimensionsofImg=function(){"object"===this.image_type&&(this.box_dim.h=40,this.box_dim.l=40),"image"===this.image_type&&(this.box_dim.l=this.img_info[0].image.width,this.box_dim.h=this.img_info[0].image.height)},t.getDataURL=function(){this.setDimensionsofImg();var e=document.createElement("canvas");e.width=this.img_info[0].image.width,e.height=this.img_info[0].image.height;for(var t=e.getContext("2d"),n=0;n<this.img_info.length;n++){var i=this.img_info[n].color,r=document.createElement("canvas");this.canvases[i]=r}for(n=0;n<this.img_info.length;n++){i=this.img_info[n].color.toString();this.createColorCanvas(this.img_info[n].image,i)}t.globalCompositeOperation="lighter";for(n=0;n<this.img_info.length;n++){var a=this.img_info[n];t.drawImage(this.canvases[a.color],this.cords.x,this.cords.y,this.box_dim.h,this.box_dim.l,0,0,e.width,e.height)}return t.globalCompositeOperation="source-over",e.toDataURL()},t.createColorCanvas=function(e,t){var n=e.height,i=e.width;this.canvases[t].width=i,this.canvases[t].height=n;var r=this.canvases[t].getContext("2d");r.globalCompositeOperation="source-over",r.drawImage(e,0,0),r.globalCompositeOperation="multiply",r.fillStyle=t,r.fillRect(0,0,i,n),r.globalCompositeOperation="source-over"},e}()},18302:function(e,t,n){"use strict";n.r(t);var i=n(85061),r=n(92137),a=n(87757),o=n.n(a),s=n(67294),c=n(96667),l=n(47798),u=n(23729),m=n(80838),g=n(83332),d=n(44005),f=n(90058),h=n(91666),p=n(80633),v=n(79312),b=n(98910),y=n(22019),w=n(6750),E=(n(37107),n(39331)),k=n(49224),Z=n(59274),_=n(31261),C=n(8441),x=n(96531),I=n(48498);t.default=function(){var e,t=s.useState(null),n=t[0],a=t[1],N=s.useState(null),S=N[0],P=N[1],R=s.useState(null),j=R[0],L=R[1],O=s.useState(null),D=O[0],T=O[1],U=s.useState(he([])),B=U[0],F=U[1],z=s.useState(null),A=z[0],$=z[1],H=s.useState(null),M=(H[0],H[1]),q=s.useState(null),G=q[0],J=q[1],K=s.useState(!1),Q=K[0],V=K[1],W=s.useState(!1),X=W[0],Y=W[1],ee=s.useState(!1),te=ee[0],ne=(ee[1],s.useState(!1)),ie=ne[0],re=ne[1],ae=s.useState(!0),oe=ae[0],se=ae[1],ce=function(e){a(null),void 0!==e&&me(e)},le=function(){V(!1),Y(!1),re(!1)},ue=function(){V(!0),Y(!0),re(!0)},me=function(){var e=(0,r.Z)(o().mark((function e(t){var n,i,r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.time("ImageProvider2"),le(),F({unclassified:[],positive:[],negative:[]}),n=new y.$(S,j),e.next=7,n.initTrainPromise();case 7:return M(t),i=n.fetchUpToNCellPairsByClass(t,20),new w.F,r=new k.z(D,S),e.next=13,r.getObjsToURLs(i);case 13:return a=e.sent,s=he(a),F(s),$(new E.e(i,a)),ue(),console.timeEnd("ImageProvider2"),e.abrupt("return");case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,r,a,s,c,l,u,m,g,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:le(),t=B.negative.map((function(e){return e.id})),n=B.positive.map((function(e){return e.id})),console.log(t,B),A.setClassByIndexArray("negative",t),A.setClassByIndexArray("positive",n),r=A.getPairsByClass("negative"),a=A.getPairsByClass("positive"),s=r.map((function(e){return S.getRow("object_data",{ImageNumber:e.ImageNumber,ObjectNumber:e.ObjectNumber})})),c=a.map((function(e){return S.getRow("object_data",{ImageNumber:e.ImageNumber,ObjectNumber:e.ObjectNumber})})),l=[].concat((0,i.Z)(s),(0,i.Z)(c)),u=new Array(s.length).fill(0),m=new Array(c.length).fill(1),g=u.concat(m),d={classifierType:"LogisticRegression",trainingData:[].concat((0,i.Z)(l),(0,i.Z)(j.trainingData)),trainingLabels:[].concat((0,i.Z)(g),(0,i.Z)(j.trainingLabels)),featuresToUse:G},console.log(d),L(d),f={unclassified:B.unclassified,positive:[],negative:[]},F(f),console.log("finished train"),ue();case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=(0,r.Z)(o().mark((function e(t){var n,i,r,a,s,c,l,u,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se(!1),T(t),n=new b.Z(t),e.next=5,n.getDataHandlerandStartingTrainingSet();case 5:i=e.sent,r=i.data_provider,P(r),a=i.training_data.training_table,s=a.getDataColumnsPaired(),c=a.getTrainingLabels(),l=s.map((function(e){var t=e.objectnum,n=e.imagenum;return r.getRow("object_data",{ObjectNumber:t,ImageNumber:n})})),u=i.training_data.features,m=u.filter((function(e){return!e.includes("Location")&&"ObjectNumber"!==e&&"ImageNumber"!==e})),J(m),console.log("finished data initialization"),L({classifierType:"LogisticRegression",trainingData:l,trainingLabels:c,featuresToUse:m}),V(!0),Y(!0),re(!0),console.log("finished upload");case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le(),t=new y.$(S,j),e.next=4,t.initTrainPromise();case 4:t.userDownloadClassifierSpecPromise(),ue();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function he(e){return{unclassified:e.map((function(e,t){return{id:t,address:e}})),positive:[],negative:[]}}return s.createElement("div",{style:{resize:"horizontal"}},s.createElement(c.Z,null,s.createElement(l.Z,null,s.createElement(p.Z,{src:h.Z,style:{marginRight:"40%",height:"90px"}})),s.createElement(l.Z,null,s.createElement(u.Z,{style:{color:"black",marginLeft:"50%"}}," ",s.createElement(v.Z,null)))),s.createElement(c.Z,null,s.createElement(m.Z,{container:!0,justify:"center",spacing:2,style:{marginBottom:15}},s.createElement(m.Z,{key:0,item:!0},s.createElement(g.Z,{disabled:!Q,variant:"contained","aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){a(e.currentTarget)}},"Fetch"),s.createElement(d.Z,{id:"simple-menu",anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:ce},s.createElement(f.Z,{onClick:function(){return ce("random")}},"Random"),s.createElement(f.Z,{onClick:function(){return ce("positive")}},"Positive"),s.createElement(f.Z,{onClick:function(){return ce("negative")}},"Negative"))),s.createElement(m.Z,{key:1,item:!0},s.createElement(g.Z,{disabled:!X,variant:"contained",onClick:ge},"Train")),s.createElement(m.Z,{key:2,item:!0},s.createElement(g.Z,{disabled:!te,variant:"contained",onClick:function(){}},"Evaluate")),s.createElement(m.Z,{key:3,item:!0},s.createElement(g.Z,{disabled:!ie,variant:"contained",onClick:fe},"Download")),s.createElement(m.Z,{key:4,item:!0},s.createElement(g.Z,{disabled:!oe,variant:"contained",component:"label",onClick:function(){return console.log("Upload!")}},"Upload",s.createElement("input",{type:"file",hidden:!0,webkitdirectory:"true",mozdirectory:"true",msdirectory:"true",odirectory:"true",directory:"true",multiple:!0,onChange:function(e){de(e)}}))))),s.createElement(C.d,{onChange:function(e,t,n,i){var r;if(i){var a,o=(0,Z.p)(B[e],B[i],t,n);return F(Object.assign({},B,((a={})[e]=o[0],a[i]=o[1],a)))}var s=(0,_.L)(B[e],t,n);return F(Object.assign({},B,((r={})[e]=s,r)))}},s.createElement("div",null,s.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"10%",marginBottom:.5}},"Unclassified"),s.createElement("div",{className:"topContainer"},s.createElement(x.$,{className:"dropzone ",id:"unclassified",boxesPerRow:8,rowHeight:70},B.unclassified.map((function(e){return s.createElement(I.P,{key:e.id},s.createElement("div",{className:"grid-item"},s.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}})))})))),s.createElement(c.Z,null,s.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"11%",userSelect:"none",marginBottom:"0.5%"}},"Positive"),s.createElement("label",{style:(e={textAlign:"left",backgroundColor:"white",paddingRight:"8%",marginBottom:0,userSelect:"none",margin:"auto"},e.marginBottom="0.5%",e)},"Negative")),s.createElement(c.Z,null,s.createElement(x.$,{className:"dropzone positive",id:"positive",boxesPerRow:4,rowHeight:70},B.positive.map((function(e){return s.createElement(I.P,{key:e.id},s.createElement("div",{className:"grid-item"},s.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}})))}))),s.createElement(x.$,{className:"dropzone negative",id:"negative",boxesPerRow:4,rowHeight:70},B.negative.map((function(e){return s.createElement(I.P,{key:e.id},s.createElement("div",{className:"grid-item"},s.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}})))})))))))}}}]);
//# sourceMappingURL=component---src-pages-index-img-prov-2-js-fa41c3284026bae5b140.js.map
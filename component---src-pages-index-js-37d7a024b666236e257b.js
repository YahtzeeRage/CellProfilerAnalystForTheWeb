(self.webpackChunkgatsby_test=self.webpackChunkgatsby_test||[]).push([[9678],{87814:function(e,t,n){"use strict";var a=n(95318),r=n(20862);t.Z=void 0;var i=r(n(67294)),l=(0,a(n(58786)).default)(i.createElement("path",{d:"M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"}),"HelpOutline");t.Z=l},53514:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var a=n(67294),r=n(49995),i=n(79312),l=n(77447),o=n(4513),s=n(65733),c=n(22122),u=n(81253),d=n(85505),m=n(68725),g=n(20638),f=n(80453),p=n(81664),h=a.forwardRef((function(e,t){e.checked;var n=e.classes,r=e.className,i=e.control,l=e.disabled,o=(e.inputRef,e.label),s=e.labelPlacement,g=void 0===s?"end":s,h=(e.name,e.onChange,e.value,(0,u.Z)(e,["checked","classes","className","control","disabled","inputRef","label","labelPlacement","name","onChange","value"])),b=(0,m.Z)(),v=l;void 0===v&&void 0!==i.props.disabled&&(v=i.props.disabled),void 0===v&&b&&(v=b.disabled);var y={disabled:v};return["checked","name","onChange","value","inputRef"].forEach((function(t){void 0===i.props[t]&&void 0!==e[t]&&(y[t]=e[t])})),a.createElement("label",(0,c.Z)({className:(0,d.Z)(n.root,r,"end"!==g&&n["labelPlacement".concat((0,p.Z)(g))],v&&n.disabled),ref:t},h),a.cloneElement(i,y),a.createElement(f.Z,{component:"span",className:(0,d.Z)(n.label,v&&n.disabled)},o))})),b=(0,g.Z)((function(e){return{root:{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,"&$disabled":{cursor:"default"}},labelPlacementStart:{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},labelPlacementTop:{flexDirection:"column-reverse",marginLeft:16},labelPlacementBottom:{flexDirection:"column",marginLeft:16},disabled:{},label:{"&$disabled":{color:e.palette.text.disabled}}}}),{name:"MuiFormControlLabel"})(h),v=n(28481),y=n(12933),E=n(23729),k=a.forwardRef((function(e,t){var n=e.autoFocus,r=e.checked,i=e.checkedIcon,l=e.classes,o=e.className,s=e.defaultChecked,g=e.disabled,f=e.icon,p=e.id,h=e.inputProps,b=e.inputRef,k=e.name,w=e.onBlur,C=e.onChange,x=e.onFocus,Z=e.readOnly,P=e.required,T=e.tabIndex,S=e.type,N=e.value,I=(0,u.Z)(e,["autoFocus","checked","checkedIcon","classes","className","defaultChecked","disabled","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"]),R=(0,y.Z)({controlled:r,default:Boolean(s),name:"SwitchBase",state:"checked"}),j=(0,v.Z)(R,2),A=j[0],O=j[1],W=(0,m.Z)(),L=g;W&&void 0===L&&(L=W.disabled);var M="checkbox"===S||"radio"===S;return a.createElement(E.Z,(0,c.Z)({component:"span",className:(0,d.Z)(l.root,o,A&&l.checked,L&&l.disabled),disabled:L,tabIndex:null,role:void 0,onFocus:function(e){x&&x(e),W&&W.onFocus&&W.onFocus(e)},onBlur:function(e){w&&w(e),W&&W.onBlur&&W.onBlur(e)},ref:t},I),a.createElement("input",(0,c.Z)({autoFocus:n,checked:r,defaultChecked:s,className:l.input,disabled:L,id:M&&p,name:k,onChange:function(e){var t=e.target.checked;O(t),C&&C(e,t)},readOnly:Z,ref:b,required:P,tabIndex:T,type:S,value:N},h)),A?i:f)})),w=(0,g.Z)({root:{padding:9},checked:{},disabled:{},input:{cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}},{name:"PrivateSwitchBase"})(k),C=n(19123),x=(0,C.Z)(a.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Z=(0,C.Z)(a.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),P=n(37595),T=(0,C.Z)(a.createElement("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),S=a.createElement(Z,null),N=a.createElement(x,null),I=a.createElement(T,null),R=a.forwardRef((function(e,t){var n=e.checkedIcon,r=void 0===n?S:n,i=e.classes,l=e.color,o=void 0===l?"secondary":l,s=e.icon,m=void 0===s?N:s,g=e.indeterminate,f=void 0!==g&&g,h=e.indeterminateIcon,b=void 0===h?I:h,v=e.inputProps,y=e.size,E=void 0===y?"medium":y,k=(0,u.Z)(e,["checkedIcon","classes","color","icon","indeterminate","indeterminateIcon","inputProps","size"]),C=f?b:m,x=f?b:r;return a.createElement(w,(0,c.Z)({type:"checkbox",classes:{root:(0,d.Z)(i.root,i["color".concat((0,p.Z)(o))],f&&i.indeterminate),checked:i.checked,disabled:i.disabled},color:o,inputProps:(0,c.Z)({"data-indeterminate":f},v),icon:a.cloneElement(C,{fontSize:void 0===C.props.fontSize&&"small"===E?E:C.props.fontSize}),checkedIcon:a.cloneElement(x,{fontSize:void 0===x.props.fontSize&&"small"===E?E:x.props.fontSize}),ref:t},k))})),j=(0,g.Z)((function(e){return{root:{color:e.palette.text.secondary},checked:{},disabled:{},indeterminate:{},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:(0,P.U1)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:(0,P.U1)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}}}}),{name:"MuiCheckbox"})(R),A=n(69817),O=n(83332);var W=function(e){var t=a.useState(!1),n=t[0],c=t[1],u=a.useState(!1),d=u[0],m=u[1],g=a.useState(!1),f=g[0],p=g[1];return a.createElement("div",null,a.createElement(l.ZP,{title:"Download","aria-label":"download"},a.createElement(r.Z,{"aria-label":"save",color:"primary",component:"label",disabled:!e.downloadButtonEnabled,onClick:function(){c(!0)},style:{positive:"relative"}}," ",a.createElement(i.Z,null))),a.createElement(o.Z,{open:n,onClose:function(){c(!1),m(!1),p(!1)},"aria-labelledby":"form-dialog-title"},a.createElement(s.Z,null,a.createElement(A.Z,{component:"legend"},"Download"),a.createElement(b,{control:a.createElement(j,{onChange:function(e){m(!d)},color:"primary"}),label:"Classifer"}),a.createElement(b,{control:a.createElement(j,{onChange:function(e){p(!f)},color:"primary"}),label:"Training Set"}),a.createElement(O.Z,{size:"small",variant:"contained",style:{bottom:10},onClick:function(){console.log(d),d&&f?e.handleDownload("TrainingSetClassifierSpec"):d?e.handleDownload("ClassifierSpec"):f&&e.handleDownload("TrainingSet")}},"Save"))))}},89549:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var a=n(67294),r=n(87814),i=n(23729),l=n(77447),o=n(60577),s=n(4513),c=n(29181),u=n(22122),d=n(81253),m=n(85505),g=n(20638),f=n(81664),p=n(58063),h=a.forwardRef((function(e,t){var n=e.classes,r=e.className,i=e.color,l=void 0===i?"primary":i,o=e.position,s=void 0===o?"fixed":o,c=(0,d.Z)(e,["classes","className","color","position"]);return a.createElement(p.Z,(0,u.Z)({square:!0,component:"header",elevation:4,className:(0,m.Z)(n.root,n["position".concat((0,f.Z)(s))],n["color".concat((0,f.Z)(l))],r,"fixed"===s&&"mui-fixed"),ref:t},c))})),b=(0,g.Z)((function(e){var t="light"===e.palette.type?e.palette.grey[100]:e.palette.grey[900];return{root:{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",zIndex:e.zIndex.appBar,flexShrink:0},positionFixed:{position:"fixed",top:0,left:"auto",right:0,"@media print":{position:"absolute"}},positionAbsolute:{position:"absolute",top:0,left:"auto",right:0},positionSticky:{position:"sticky",top:0,left:"auto",right:0},positionStatic:{position:"static"},positionRelative:{position:"relative"},colorDefault:{backgroundColor:t,color:e.palette.getContrastText(t)},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},colorInherit:{color:"inherit"},colorTransparent:{backgroundColor:"transparent",color:"inherit"}}}),{name:"MuiAppBar"})(h),v=n(80453),y=n(34129),E=n(65733),k=n(32253),w=n(9901),C=a.forwardRef((function(e,t){return a.createElement(o.Z,Object.assign({direction:"up",ref:t},e))}));var x=function(){var e=a.useState(!1),t=e[0],n=e[1],o=function(){n(!1)};return a.createElement("div",null,a.createElement(l.ZP,{title:"Help","aria-label":"help"},a.createElement(i.Z,{color:"primary",onClick:function(){n(!0)},style:{height:65,width:65}},a.createElement(r.Z,{size:"large",style:{height:50,width:50}}))),a.createElement(s.Z,{fullScreen:!0,open:t,onClose:o,TransitionComponent:C},a.createElement(b,null,a.createElement(y.Z,null,a.createElement(v.Z,{variant:"h6",color:"inherit"},"Info"),a.createElement(i.Z,{color:"inherit",onClick:o,"aria-label":"close",style:{marginLeft:"93%",position:"fixed"}},a.createElement(c.Z,null)))),a.createElement(w.Z,null,"Subscribe"),a.createElement(E.Z,null,a.createElement("br",null),a.createElement("h5",null,"Getting Started "),a.createElement(k.Z,null,"Import your data files from Cell Profiler by clicking the upload data button in the right corner. Below is a link to download Cell Profiler, if you still need to prepare you data for import:",a.createElement("br",null),a.createElement("a",{href:"https://cellprofiler.org/"},"https://cellprofiler.org/"),a.createElement("br",null),a.createElement("br",null),"If you are just looking to give CPA Web a try, download the example data at the link below and unzip it before uploading to the program:",a.createElement("br",null),a.createElement("a",{href:"https://cellprofileranalyst.org/examples"},"https://cellprofileranalyst.org/examples"),a.createElement("br",null),a.createElement("br",null),"You will know your data is loaded when the green circle stops spinning.",a.createElement("hr",null)),a.createElement("h5",null,"Using CPA Web "),a.createElement(k.Z,null,"Once your data is uploaded, you can begin fetching cells to classify!",a.createElement("br",null),a.createElement("br",null),"You have the option to fetch: random cells from your data set, positive cells (cells that possess the phenotype/ trait you are classifying for), negative cells (cells that do not possess the phenotype/ trait you are classifying for), cells from a specific image in your data set, cells from your positive or negative training set, and cells that are confusing to classifier (the cells that the classifier is most unsure are positive or negative). You can also fetch the cells the classifier thinks arre most positive or most negative from a large sample. However if a particular phenotype is rare the program may ask for confirmation to continue.",a.createElement("br",null),a.createElement("br",null),"It is a good idea to start by fetching random cells so the model can begin to learn based on your classifications.",a.createElement("hr",null)),a.createElement("h5",null,"Classifying Cells "),a.createElement(k.Z,null,"Once you have fetched cells and they appear in the unclassified bin, you can begin dragging and dropping the cells into the positive and negative bin based on the phenotype/trait you are classifying for.",a.createElement("br",null),a.createElement("br",null),"When you hover over cell images you learn their image and object numbers. If you double click on a cell, the full image the cell belongs to will pop up and show you where in the image the cell is coming from.",a.createElement("br",null),a.createElement("br",null),"When you feel happy with the cells in the positive and negative bin, you can press the train button to train the model. While the model is training you will see loss and accuracy graphs informing you on the models progress.",a.createElement("br",null),a.createElement("br",null),"If there are cells you are unsure about or do not want to include in the training set, simply fetch again and the cells go away. Also note that when you press train the cells in the unclassified bin will go away.",a.createElement("hr",null)),a.createElement("h5",null,"Exploring The Data "),a.createElement(k.Z,null,"To evaluate the state of the machine learning model you can press the evaluate button to see the confusion matrix.",a.createElement("br",null),a.createElement("br",null),"To gain more insight on the cell images scorings, you can click on the score all button. This displays a histogram of the data distribution and a table containing information about all the cell images, their total, positive, negative, ratio, and adjusted ratio values. You can sort the values in the table from biggest to smallest by hovering over the column label and selecting the direction of the arrow. You can download the CSV of the score all table by pressing the save icon in the right corner of the score all window.",a.createElement("hr",null)),a.createElement("h5",null,"Saving Your Work"),a.createElement(k.Z,null,"When you are satisfied with your model, simply click the download button in the top right corner of the main screen to download your classification model and training set.",a.createElement("hr",null)),a.createElement("h5",null,"Additional Questions"),a.createElement(k.Z,null,"If you have any additional questions on how to use Cell Profiler Analyst Web, please post on the cell profiler analyst forum:",a.createElement("br",null),a.createElement("a",{href:"https://forum.image.sc/tag/cellprofiler-analyst"},"https://forum.image.sc/tag/cellprofiler-analyst"),a.createElement("br",null),a.createElement("br",null),"Happy Classifying!"))))}},84799:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(67294),r=n(4513),i=n(65733),l=n(9901);function o(e){return a.createElement(r.Z,{style:{alignItems:"center"},onClose:e.onClose,open:e.open},a.createElement(l.Z,null,e.title),a.createElement(i.Z,{style:{alignItems:"center",justifyContent:"center"}},a.createElement("img",{width:430,height:430,src:e.src})))}},45133:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var a=n(4513),r=n(89952),i=n(65733),l=n(32253),o=n(9901),s=n(31690),c=n(1097),u=n(83332),d=n(67294);function m(e){var t=d.useState(1),n=t[0],m=t[1];return d.createElement(a.Z,{open:e.open,onClose:e.onCancel},d.createElement(o.Z,null,"Fetch By Image"),d.createElement(i.Z,null,d.createElement(l.Z,null,"Select the image number you would like to fetch from."),d.createElement("form",{noValidate:!0,onSubmit:function(t){t.preventDefault(),e.onSubmit()}},d.createElement(s.Z,null,d.createElement(c.Z,{onChange:function(t){var n=t.target.value;null!=n&&""!==n&&(e.onChangeValue(n),m(parseInt(n)))},type:"number",inputProps:{step:1,min:1},value:n,label:"Image Number"})))),d.createElement(r.Z,null,d.createElement(u.Z,{onClick:e.onSubmit,color:"primary"},"Ok")))}},93939:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(4513),r=n(65733),i=n(9901),l=n(67294);function o(e){return l.createElement(a.Z,{fullWidth:500,open:e.open},l.createElement(i.Z,null,"Training the Classifier"),l.createElement(r.Z,null,l.createElement("div",{width:300,ref:e.graph1DivRef}),l.createElement("div",{width:300,ref:e.graph2DivRef})))}},45037:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(4513),r=n(32253),i=n(9901),l=n(67294);function o(){var e=(0,l.useState)(!1),t=e[0],n=e[1];return(0,l.useEffect)((function(){"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof ImageBitmap&&"undefined"!=typeof Worker&&"undefined"!=typeof indexedDB||n(!0)}),[]),l.createElement(a.Z,{fullWidth:1e3,open:t},l.createElement(i.Z,null,"Compatibility Error:"),l.createElement(r.Z,{align:"center",style:{marginLeft:20,marginRight:20}},"Your browser is not compatible with this app. Please use an up-to-date version of Edge or Chrome."))}},97704:function(e,t,n){"use strict";n.r(t);var a=n(85061),r=n(92137),i=n(87757),l=n.n(i),o=n(67294),s=n(96667),c=n(47798),u=n(80838),d=n(83332),m=n(44005),g=n(90058),f=n(20458),p=n(80633),h=n(27136),b=n(58063),v=n(88816),y=n(14195),E=n(9789),k=n(89549),w=n(17710),C=n(59274),x=n(31261),Z=n(8441),P=n(96531),T=n(48498),S=n(67253),N=n(74243),I=n(44911),R=n(74298),j=n(53514),A=n(45037),O=n(45133),W=n(93939),L=n(84799);t.default=function(){var e=o.useState(null),t=e[0],n=e[1],i=o.useState({unclassified:[],positive:[],negative:[]}),M=i[0],B=i[1],D=o.useState(!1),F=D[0],z=D[1],H=o.useState(!1),U=H[0],Y=H[1],V=o.useState(!1),$=V[0],q=V[1],X=o.useState(!1),G=X[0],_=X[1],Q=o.useState(!0),J=Q[0],K=Q[1],ee=o.useState(!1),te=ee[0],ne=ee[1],ae=o.useState(!1),re=ae[0],ie=ae[1],le=o.useState(!1),oe=le[0],se=le[1],ce=o.useState(!1),ue=ce[0],de=ce[1],me=o.useState(!1),ge=me[0],fe=me[1],pe=o.useState(!1),he=pe[0],be=pe[1],ve=o.useState(null),ye=ve[0],Ee=ve[1],ke=o.useState(null),we=ke[0],Ce=ke[1],xe=o.useState(null),Ze=xe[0],Pe=xe[1],Te=o.useState([[0,0],[0,0]]),Se=Te[0],Ne=Te[1],Ie=o.useState(null),Re=Ie[0],je=Ie[1],Ae=o.useState(!1),Oe=Ae[0],We=Ae[1],Le=o.useState([]),Me=Le[0],Be=Le[1],De=o.useState(),Fe=De[0],ze=De[1],He=o.useState([]),Ue=He[0],Ye=He[1],Ve=o.useRef(),$e=o.useRef(),qe=o.useState(1),Xe=qe[0],Ge=qe[1],_e=o.useState(!1),Qe=_e[0],Je=_e[1],Ke=o.useState(w.Z),et=Ke[0],tt=Ke[1],nt=o.useState(""),at=nt[0],rt=nt[1],it=o.useState(!1),lt=it[0],ot=it[1],st=o.useState(""),ct=st[0],ut=st[1];o.useEffect((function(){window.addEventListener("beforeunload",(function(e){return e.preventDefault(),e.returnValue="Sure?","Sure?"}))}),[]),o.useEffect((function(){var e=new MessageChannel,t=new MessageChannel,n=new MessageChannel,a=dt("dataWorker.js","dataWebWorker");a.postMessage({action:"connectToClassifierWorker"},[t.port1]),a.postMessage({action:"connectToCanvasWorker"},[e.port1]),Ce(a);var r=dt("classifierWorker.js","classifierWebWorker");r.postMessage({action:"connectToDataWorker"},[t.port2]),r.postMessage({action:"connectToCanvasWorker"},[n.port1]),Pe(r);var i=dt("canvasWorker.js","CanvasWebWorker");i.postMessage({action:"connectToDataWorker"},[e.port2]),i.postMessage({action:"connectToClassifierWorker"},[n.port2]),Ee(i)}),[]);var dt=function(e,t){var n=new Worker(e);return n.addEventListener("error",(function(e){console.log("["+t+"] Error",e.message,e)})),n},mt=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Je(!0),rt("Image: "+t.ImageNumber+", Object: "+t.ObjectNumber),e.abrupt("return",bt(ye,"get",{getType:"blobUrlBigPictureFromCellPair",getArgs:{cellPair:t}}).then((function(e){var t=e.data.getResult;tt(t)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gt=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return Je(!0),rt("Image: "+t),e.abrupt("return",bt(ye,"get",{getType:"blobUrlBigPictureByImageNumber",getArgs:{imageNumber:t}}).then((function(e){var t=e.data.getResult;tt(t)})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=(0,r.Z)(l().mark((function e(t){var a,r,i,o,s,c,u,d,m,g,f,p,h,b,v,y,E,k,w,C,x,Z,P,T,S,N,I,R,j,A,O,W,L,D,F,z,H,U,Y,V,$,q,X,G,_,Q,J,K,ee,te,ne,ae,re,ie,le,oe;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n(null),!(void 0===t|null==t)){e.next=3;break}return e.abrupt("return");case 3:se(!0),a=Object.assign({},M,{unclassified:[]}),B(a),e.t0=t,e.next="Random"===e.t0?9:"Positive"===e.t0||"Negative"===e.t0?23:"Confusing"===e.t0?72:"MorePositive"===e.t0||"MoreNegative"===e.t0?91:"ImageNumber"===e.t0?141:"TrainingPositive"===e.t0||"TrainingNegative"===e.t0?162:176;break;case 9:return e.next=11,bt(we,"get",{getType:"cellPairs",getArgs:{amount:16}});case 11:return r=e.sent,i=r.data.getResult,e.next=15,bt(ye,"get",{getType:"blobUrlsFromCellPairs",getArgs:{cellPairs:i}});case 15:return r=e.sent,o=r.data.getResult,e.next=19,Ct(M,o,i);case 19:return s=e.sent,B(s),se(!1),e.abrupt("break",176);case 23:c=[],u=0,d=0;case 26:if(!(c.length<16)){e.next=61;break}return e.next=29,bt(we,"get",{getType:"cellPairs",getArgs:{amount:100}});case 29:return m=e.sent,g=m.data.getResult,e.next=33,bt(Ze,"predictFilterCellPairs",{cellPairs:g,classType:t});case 33:m=e.sent,f=m.data.filteredCellPairs,p=0;case 36:if(!(p<f.length)){e.next=51;break}h=f[p],b=!0,v=0;case 40:if(!(v<c.length)){e.next=47;break}if(h.ImageNumber!==c[v].ImageNumber||h.ObjectNumber!==c[v].ObjectNumber){e.next=44;break}return b=!1,e.abrupt("break",47);case 44:v++,e.next=40;break;case 47:b&&c.push(h);case 48:p++,e.next=36;break;case 51:if(d++,!(u++>=1e3)){e.next=59;break}if(!window.confirm("CPAW Has Found "+c.length+" Unique "+t+" Cells After Testing "+100*d+" Cells With Replacement, Would You Like To Continue?")){e.next=58;break}return u=0,e.abrupt("continue",26);case 58:return e.abrupt("break",61);case 59:e.next=26;break;case 61:return y=c.slice(0,16),e.next=64,bt(ye,"get",{getType:"blobUrlsFromCellPairs",getArgs:{cellPairs:y}});case 64:return E=e.sent,k=E.data.getResult,e.next=68,Ct(M,k,y);case 68:return w=e.sent,B(w),se(!1),e.abrupt("break",176);case 72:return e.next=74,bt(we,"get",{getType:"cellPairs",getArgs:{amount:1e3}});case 74:return C=e.sent,x=C.data.getResult,e.next=78,bt(Ze,"confusingSortCellPairs",{cellPairs:x});case 78:return C=e.sent,Z=C.data.sortedCellPairs,P=Z.slice(0,16),e.next=83,bt(ye,"get",{getType:"blobUrlsFromCellPairs",getArgs:{cellPairs:P}});case 83:return C=e.sent,T=C.data.getResult,e.next=87,Ct(M,T,P);case 87:return S=e.sent,B(S),se(!1),e.abrupt("break",176);case 91:N="MorePositive"===t?"Positive":"Negative",I=[],R=0,j=0;case 95:if(!(I.length<16)){e.next=130;break}return e.next=98,bt(we,"get",{getType:"cellPairs",getArgs:{amount:1e3}});case 98:return A=e.sent,O=A.data.getResult,e.next=102,bt(Ze,"moreClassSortCellPairs",{cellPairs:O,classType:N});case 102:A=e.sent,W=A.data.sortedCellPairs,L=0;case 105:if(!(L<W.length)){e.next=120;break}D=W[L],F=!0,z=0;case 109:if(!(z<I.length)){e.next=116;break}if(D.ImageNumber!==I[z].ImageNumber||D.ObjectNumber!==I[z].ObjectNumber){e.next=113;break}return F=!1,e.abrupt("break",116);case 113:z++,e.next=109;break;case 116:F&&I.push(D);case 117:L++,e.next=105;break;case 120:if(j++,!(R++>=1e3)){e.next=128;break}if(!window.confirm("CPAW Has Found "+I.length+" Unique "+t+" Cells After Testing "+100*j+" Cells With Replacement, Would You Like To Continue?")){e.next=127;break}return R=0,e.abrupt("continue",95);case 127:return e.abrupt("break",130);case 128:e.next=95;break;case 130:return H=I.slice(0,16),e.next=133,bt(ye,"get",{getType:"blobUrlsFromCellPairs",getArgs:{cellPairs:H}});case 133:return U=e.sent,Y=U.data.getResult,e.next=137,Ct(M,Y,H);case 137:return V=e.sent,B(V),se(!1),e.abrupt("break",176);case 141:return e.next=143,bt(we,"get",{getType:"cellPairsFromImage",getArgs:{ImageNumber:Xe}});case 143:if($=e.sent,0!==(q=$.data.getResult).length){e.next=149;break}return alert("No Cells Found With Image Number: "+Xe),se(!1),e.abrupt("return");case 149:if(X=q,q.length>16)for(G=new Array(q.length).fill(0).map((function(e,t){return t})),X=[];X.length<16;)_=Math.floor(Math.random()*G.length),Q=G[_],X.push(q[Q]),G.splice(_,1);return J=X.slice(0,16),e.next=154,bt(ye,"get",{getType:"blobUrlsFromCellPairs",getArgs:{cellPairs:J}});case 154:return $=e.sent,K=$.data.getResult,e.next=158,Ct(M,K,J);case 158:return ee=e.sent,B(ee),se(!1),e.abrupt("break",176);case 162:return te=Re.trainingData.map((function(e){return{ImageNumber:e[0],ObjectNumber:e[1]}})),ne=te.filter((function(e,t){return 1===Re.trainingLabels[t]})),ae=te.filter((function(e,t){return 0===Re.trainingLabels[t]})),re="TrainingPositive"===t?ne:ae,e.next=168,bt(ye,"get",{getType:"blobUrlsFromCellPairs",getArgs:{cellPairs:re}});case 168:return ie=e.sent,le=ie.data.getResult,e.next=172,Ct(M,le,re);case 172:return oe=e.sent,B(oe),se(!1),e.abrupt("break",176);case 176:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pt=function(){var e=(0,r.Z)(l().mark((function e(){var t,n,r,i,o,s,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Train!"),t=M.positive.map((function(e){return e.cellPair})),n=M.negative.map((function(e){return e.cellPair})),r=[].concat((0,a.Z)(n),(0,a.Z)(t)),i=[].concat((0,a.Z)(new Array(n.length).fill(0)),(0,a.Z)(new Array(t.length).fill(1))),We(!1),o=Object.assign({},M,{unclassified:[]}),B(o),e.next=10,bt(we,"get",{getType:"objectRowsFromCellpairs",getArgs:{cellPairs:r}});case 10:s=e.sent,c=s.data.getResult,u={classifierType:"LogisticRegression",trainingData:c,trainingLabels:i,featureIndicesToUse:Re.featureIndicesToUse},ht(u);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ht=function(){var e=(0,r.Z)(l().mark((function e(t){var n,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return be(!0),n=null,r=function(e){if(n==e.data.uuid)switch(e.data.action){case"updateTrainingCanvases":N.show.history(Ve.current,e.data.trainLogs,[].concat((0,a.Z)(e.data.ticks.loss),(0,a.Z)(e.data.ticks.accuracy)));break;default:console.log("didn't render bad action")}},e.abrupt("return",bt(Ze,"startTrainingGraphsConnection",{}).then((function(e){return n=e.data.uuid,Ze.addEventListener("message",r),bt(Ze,"train",{trainingObject:t})})).then((function(){return bt(Ze,"endTrainingGraphsConnection",{}),Ze.removeEventListener("message",r),bt(Ze,"confusionMatrix")})).then((function(e){var t=e.data.confusionMatrix;Ne(t)})).then((function(){je(t),be(!1)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bt=function(e,t,n){var a=(0,E.Z)();return new Promise((function(r){e.addEventListener("message",(function t(n){n.data.uuid===a&&(e.removeEventListener("message",t),r(n))})),e.postMessage(Object.assign({action:t},n,{uuid:a}))}))},vt=function(){var e=(0,r.Z)(l().mark((function e(t){var n,r,i,o,s,c,u,d,m,g,f;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Upload!"),ne(!0),e.next=4,bt(we,"init",{fileListObject:t.target.files});case 4:return e.next=6,bt(we,"get",{getType:"trainingObject"});case 6:return n=e.sent,r=n.data.getResult,ne(!1),ie(!0),K(!1),e.next=13,ht(r);case 13:return de(!0),i=r.trainingData.map((function(e){return{ImageNumber:e[0],ObjectNumber:e[1]}})),o=i.filter((function(e,t){return 1===r.trainingLabels[t]})),s=i.filter((function(e,t){return 0===r.trainingLabels[t]})),c=[].concat((0,a.Z)(s),(0,a.Z)(o)),e.next=20,bt(ye,"get",{getType:"blobUrlsFromCellPairs",getArgs:{cellPairs:c}});case 20:return n=e.sent,u=n.data.getResult,d=new Array(s.length).fill(0),m=new Array(o.length).fill(1),g=[].concat((0,a.Z)(d),(0,a.Z)(m)),e.next=27,Zt(u,c,g);case 27:f=e.sent,B(f),se(!1),de(!1),z(!0),Y(!0),_(!0),q(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yt=function(e,t){void 0===t&&(t=null);var n="";return null!==t&&(n+=t.join(",")+"\n"),n+=e.map((function(e){return e.join(",")})).join("\n")},Et=function(){var e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Score All!"),Oe||lt){e.next=4;break}return ot(!0),e.abrupt("return",bt(Ze,"scoreObjectData").then((function(e){var t=e.data.scoreTableObject,n=Object.keys(t.imageToCountsMap).map((function(e){return{imageNumber:parseInt(e),total:t.imageToCountsMap[e][0]+t.imageToCountsMap[e][1],positive:t.imageToCountsMap[e][1],negative:t.imageToCountsMap[e][0],ratio:t.ratios[e],adjustratio:t.adjustedRatios[e]}})),a=(t.alphas[1],t.alphas[0],Object.values(t.adjustedRatios).map((function(e){return{x:e}})));Ye(a),Be(n),ot(!1),ze(t.alphas);var r=n.map((function(e){return[e.imageNumber,e.positive,e.negative,e.total,e.ratio,e.adjustratio]})),i=yt(r,["ImageNumber","PositiveCount","NegativeCount","TotalCount","Ratio","AdjustedRatio"]);ut(i),We(!0)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function kt(e){var t="";t=(t=t.concat("# This training set was created at "+(new Date).toLocaleString()+" in CellProfiler Analyst Web\n")).concat("label positive negative\n");for(var n=0;n<e.positive.length;n++){var a=e.positive[n].data;t=t.concat("positive "+a.ImageNumber+" "+a.ObjectNumber+" "+a.X+" "+a.Y+"\n")}for(var r=0;r<e.negative.length;r++){var i=e.negative[r].data;t=t.concat("negative "+i.ImageNumber+" "+i.ObjectNumber+" "+i.X+" "+i.Y+"\n")}return t}var wt=function(){var e=(0,r.Z)(l().mark((function e(t){var n,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Download!"),"TrainingSet"!==t){e.next=7;break}return n=kt(M),(0,I.S)("generatedTrainingSet",n,".txt"),e.abrupt("return");case 7:if("ClassifierSpec"!==t){e.next=11;break}return e.abrupt("return",bt(Ze,"getClassifier").then((function(e){S.FBF("indexeddb://"+Re.classifierType).then((function(e){e.save("downloads://"+Re.classifierType)}))})));case 11:if("TrainingSetClassifierSpec"!==t){e.next=17;break}return a=kt(M),(0,I.S)("generatedTrainingSet",a,".txt"),e.abrupt("return",bt(Ze,"getClassifier").then((function(e){S.FBF("indexeddb://"+Re.classifierType).then((function(e){e.save("downloads://"+Re.classifierType)}))})));case 17:console.error("no valid downloadtype");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Ct(e,t,n){return xt.apply(this,arguments)}function xt(){return(xt=(0,r.Z)(l().mark((function e(t,n,a){var r,i,o,s,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(a.map((function(e){return bt(we,"get",{getType:"cellPairData",getArgs:{cellPair:e}}).then((function(e){return e.data.getResult}))})));case 2:for(r=e.sent,i=0;i<t.negative.length;i++)t.negative[i].id=i;for(o=0;o<t.positive.length;o++)t.positive[o].id=t.negative.length+o;return s=n.map((function(e,n){var a=r[n],i="Ob: "+a.ObjectNumber+" Im: "+a.ImageNumber;return{id:t.positive.length+t.negative.length+n,address:e,info:i,data:a,cellPair:{ImageNumber:a.ImageNumber,ObjectNumber:a.ObjectNumber}}})),c={negative:t.negative,positive:t.positive,unclassified:s},e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zt(e,t,n){return Pt.apply(this,arguments)}function Pt(){return(Pt=(0,r.Z)(l().mark((function e(t,n,a){var r,i,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return bt(we,"get",{getType:"cellPairData",getArgs:{cellPair:e}}).then((function(e){return e.data.getResult}))})));case 2:return r=e.sent,i=t.map((function(e,t){var n=r[t];return{id:t,address:e,info:"Ob: "+n.ObjectNumber+" Im: "+n.ImageNumber,data:n,cellPair:{ImageNumber:n.ImageNumber,ObjectNumber:n.ObjectNumber}}})),o={negative:i.filter((function(e,t){return 0===a[t]})),positive:i.filter((function(e,t){return 1===a[t]})),unclassified:i.filter((function(e,t){return-1===a[t]}))},e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return console.log("Load the App"),o.createElement(Z.d,{onChange:function(e,t,n,a){var r;if(a){var i,l=(0,C.p)(M[e],M[a],t,n);return B(Object.assign({},M,((i={})[e]=l[0],i[a]=l[1],i)))}var o=(0,x.L)(M[e],t,n);return B(Object.assign({},M,((r={})[e]=o,r)))}},o.createElement(A.default,null),o.createElement("div",{style:{overflowX:"hidden",height:"100%",width:"100%"}},o.createElement(s.Z,{style:{marginTop:"2%"}},o.createElement(p.Z,{src:f.Z,style:{marginLeft:"11%",height:"30%",width:"25%",position:"relative",maxHeight:"125px",marginBottom:"2%"}}),o.createElement(c.Z,{style:{left:"35%"}},o.createElement(k.default,null)),o.createElement(c.Z,{style:{left:"20%",right:5}},o.createElement(R.default,{handleUpload:vt,uploadButtonEnabled:J,uploading:te,success:re})),o.createElement(c.Z,{style:{left:"5%"}},o.createElement(j.default,{downloadButtonEnabled:G,handleDownload:wt}))),o.createElement(s.Z,null,o.createElement(b.Z,{variant:"outlined",style:{marginLeft:"30%",marginRight:"30%",height:75,width:550,outlineColor:"#6697CD"}},o.createElement(u.Z,{container:!0,justify:"center",spacing:2,style:{marginBottom:10,marginTop:10}},o.createElement(u.Z,{key:0,item:!0},o.createElement(d.Z,{disabled:!F,variant:"contained","aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){return n(e.currentTarget)}},"Fetch"),o.createElement(m.Z,{id:"simple-menu",anchorEl:t,keepMounted:!0,open:Boolean(t),onClose:ft,onSubmit:function(e){e.preventDefault(),ft()}},o.createElement(g.Z,{onClick:function(){return ft("Random")}},"Random"),o.createElement(g.Z,{onClick:function(){return ft("Positive")}},"Positive"),o.createElement(g.Z,{onClick:function(){return ft("Negative")}},"Negative"),o.createElement(g.Z,{onClick:function(){n(null),fe(!0)}},"By Image"),o.createElement(g.Z,{onClick:function(){return ft("Confusing")}},"Confusing"),o.createElement(g.Z,{onClick:function(){return ft("MorePositive")}},"Most Positive"),o.createElement(g.Z,{onClick:function(){return ft("MoreNegative")}},"Most Negative"),o.createElement(g.Z,{onClick:function(){return ft("TrainingPositive")}},"Training Set Positive"),o.createElement(g.Z,{onClick:function(){return ft("TrainingNegative")}},"Training Set Negative"),o.createElement(O.default,{open:ge,onCancel:function(){fe(!1),ft(void 0)},onSubmit:function(){fe(!1),ft("ImageNumber")},onChangeValue:function(e){console.log(parseInt(e)),Ge(parseInt(e))}}))),o.createElement(u.Z,{key:1,item:!0},o.createElement(d.Z,{disabled:!U,variant:"contained",onClick:pt},"Train"),o.createElement(W.default,{open:he,graph1DivRef:$e,graph2DivRef:Ve})),o.createElement(u.Z,{key:2,item:!0},$?o.createElement(v.default,{confusionMatrix:Se}):o.createElement(d.Z,{disabled:!$,variant:"contained",onClick:function(){}},"Evaluate")),o.createElement(u.Z,{key:3,item:!0},$?o.createElement(y.default,{histogramData:Ue,scoreTable:Me,handleScoreAll:Et,scoreTableIsUpToDate:Oe,scoreTableCsvString:ct,alphas:Fe,handleOpenBigPicture:function(e){return gt(e)}}):o.createElement(d.Z,{disabled:!$,variant:"contained",onClick:Et},"Score All"))))),o.createElement("div",null,o.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"10%",marginBottom:"0.5%",userSelect:"none"}},"Unclassified"," "),o.createElement("div",null,o.createElement(P.$,{className:"dropzone ",id:"unclassified",boxesPerRow:8,rowHeight:80,style:{height:"20vw",maxHeight:200,minHeight:150,marginBottom:10,marginLeft:"10%",width:"80%"}},oe?o.createElement(h.Z,{style:{height:"6vw",width:"6vw",marginTop:"6%",marginLeft:"45%"}}):M.unclassified.map((function(e){return o.createElement(T.P,{className:"hoverTest",style:{height:"15vw",width:"15vw",minHeight:80,minWidth:80,maxHeight:120,maxWidth:120,padding:10},key:e.id},o.createElement("div",{className:"grid-item"},o.createElement("div",{onDoubleClick:function(){mt(e.cellPair)},className:"grid-item-content",style:{backgroundImage:"url("+e.address+")",height:"5vw",width:"5vw"}},o.createElement("span",{className:"hoverText"},e.info))))}))),o.createElement(L.default,{open:Qe,onClose:function(){Je(!1)},src:et,title:at})),o.createElement(s.Z,null,o.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"11%",userSelect:"none",marginBottom:"0.5%",marginTop:0}},"Positive"),o.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingRight:"8%",userSelect:"none",margin:"auto",marginBottom:"0.5%",marginTop:0}},"Negative")),o.createElement(s.Z,null,o.createElement("div",{style:{width:"39%",marginLeft:"11%"}},o.createElement("div",{style:{height:"200px",width:"100%",overflowY:"scroll",overflowX:"hidden"}},o.createElement(P.$,{className:"dropzone positive",id:"positive",boxesPerRow:4,rowHeight:80,style:{height:80*Math.floor(M.positive.length/4+1),minHeight:240,width:"100%",overflowY:"hidden",alignSelf:"flex-end"}},ue?o.createElement(h.Z,{style:{height:"6vw",width:"6vw",marginTop:"15%",marginLeft:"43%"}}):M.positive.map((function(e){return o.createElement(T.P,{className:"hoverTest",style:{height:"15vw",width:"15vw",minHeight:80,minWidth:80,maxHeight:105,maxWidth:105,padding:10},key:e.id},o.createElement("div",{className:"grid-item"},o.createElement("div",{onDoubleClick:function(){mt(e.cellPair)},className:"grid-item-content",style:{backgroundImage:"url("+e.address+")",height:"5vw",width:"5vw"}},o.createElement("span",{className:"hoverText"},e.info))))}))))),o.createElement("div",{style:{width:"39%",marginRight:"11%"}},o.createElement("div",{style:{height:"200px",width:"100%",overflowY:"scroll",overflowX:"hidden"}},o.createElement(P.$,{className:"dropzone negative",id:"negative",boxesPerRow:4,rowHeight:80,style:{height:80*Math.floor(M.negative.length/4+1),minHeight:240,marginRight:"22%",width:"100%",overflowY:"hidden",alignSelf:"flex-start"}},ue?o.createElement(h.Z,{style:{height:"6vw",width:"6vw",marginTop:"15%",marginLeft:"43%"}}):M.negative.map((function(e){return o.createElement(T.P,{className:"hoverTest",style:{height:"15vw",width:"15vw",minHeight:80,minWidth:80,maxHeight:105,maxWidth:105,padding:10},key:e.address},o.createElement("div",{className:"grid-item"},o.createElement("div",{onDoubleClick:function(){mt(e.cellPair)},className:"grid-item-content",style:{backgroundImage:"url("+e.address+")",height:"5vw",width:"5vw"}},o.createElement("span",{className:"hoverText"},e.info))))})))))))))}}}]);
//# sourceMappingURL=component---src-pages-index-js-37d7a024b666236e257b.js.map
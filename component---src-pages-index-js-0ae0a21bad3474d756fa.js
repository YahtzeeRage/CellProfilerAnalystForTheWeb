(self.webpackChunkgatsby_test=self.webpackChunkgatsby_test||[]).push([[678],{66722:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(85061),a=n(92137),i=n(87757),o=n.n(i),l=n(67294),c=n(96667),s=n(47798),u=n(23729),m=n(80838),d=n(83332),g=n(52680),f=n(90058),p=n(91666),v=n(80633),b=n(79312),E=n(98910),y=(n(22019),n(68396)),h=n(13967),Z=n(37107),k=n(39331);var w=n(59274),N=n(31261),C=n(8441),P=n(96531),x=n(48498);var I=function(){var e;console.log("a");var t=l.useState(null),n=t[0],i=t[1],I=l.useState(null),R=I[0],S=I[1],j=l.useState(null),L=j[0],D=j[1],A=l.useState(null),B=A[0],_=A[1],O=l.useState(be([])),T=O[0],U=O[1],z=l.useState(null),F=z[0],H=z[1],$=l.useState(null),q=($[0],$[1],l.useState(null)),M=q[0],G=q[1],J=l.useState(!1),K=J[0],Q=J[1],V=l.useState(!1),W=V[0],X=V[1],Y=l.useState(!1),ee=Y[0],te=(Y[1],l.useState(!1)),ne=te[0],re=te[1],ae=l.useState(!0),ie=ae[0],oe=ae[1],le=l.useState(null),ce=le[0],se=le[1],ue=function(e){i(null),void 0!==e&&ge(e)},me=function(){Q(!1),X(!1),re(!1)},de=function(){Q(!0),X(!0),re(!0)},ge=function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,l,c,s,u,m,d,g,f,p,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(me(),U({unclassified:[],positive:[],negative:[]}),n=R.getNRandomObjs(100),r=n.map((function(e){return R.getRow("object_data",e)})),a=0,"positive"==t&&(a=1),i=ce.predict(r),l=n,"random"!==t&&(l=n.filter((function(e,t){return i[t]===a}))),l=l.slice(0,20),c=new y.p,s=null,"random"!==t){e.next=25;break}return u=l.map((function(e){var t=R.returnAllImgFileNames(e.ImageNumber).map((function(e){return B.findFile(e)})).map((function(e){return B.fileReaderPromiseImage(e)}));return Promise.all(t).then((function(t){var n=R.getCordsforCellDisplay(e);return c.getDataURLPromise(t,n)}))})),e.next=17,Promise.all(u);case 17:return m=e.sent,d=be(m),U(d),console.log(d),console.log(m),H(new k.e(l,m)),de(),e.abrupt("return");case 25:if("positive"!==t){e.next=37;break}return s=l.map((function(e){var t=R.returnAllImgFileNames(e.ImageNumber).map((function(e){return B.findFile(e)})).map((function(e){return B.fileReaderPromiseImage(e)}));return Promise.all(t).then((function(t){var n=R.getCordsforCellDisplay(e);return c.getDataURLPromise(t,n)}))})),e.next=29,Promise.all(s);case 29:return g=e.sent,f=be(g),U(f),console.log(f),console.log(g),H(new k.e(l,g)),de(),e.abrupt("return");case 37:if("negative"!==t){e.next=49;break}return s=l.map((function(e){var t=R.returnAllImgFileNames(e.ImageNumber).map((function(e){return B.findFile(e)})).map((function(e){return B.fileReaderPromiseImage(e)}));return Promise.all(t).then((function(t){var n=R.getCordsforCellDisplay(e);return c.getDataURLPromise(t,n)}))})),e.next=41,Promise.all(s);case 41:return p=e.sent,v=be(p),U(v),console.log(v),console.log(p),H(new k.e(l,p)),de(),e.abrupt("return");case 49:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,a.Z)(o().mark((function e(){var t,n,a,i,l,c,s,u,m,d,g,f,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return me(),t=T.negative.map((function(e){return e.id})),n=T.positive.map((function(e){return e.id})),a={unclassified:T.unclassified,positive:[],negative:[]},U(a),console.log(t,T),F.setClassByIndexArray("negative",t),F.setClassByIndexArray("positive",n),i=F.getPairsByClass("negative"),l=F.getPairsByClass("positive"),c=i.map((function(e){return R.getRow("object_data",{ImageNumber:e.ImageNumber,ObjectNumber:e.ObjectNumber})})),s=l.map((function(e){return R.getRow("object_data",{ImageNumber:e.ImageNumber,ObjectNumber:e.ObjectNumber})})),u=[].concat((0,r.Z)(c),(0,r.Z)(s)),m=new Array(c.length).fill(0),d=new Array(s.length).fill(1),g=m.concat(d),f={classifierType:"LogisticRegression",trainingData:[].concat((0,r.Z)(u),(0,r.Z)(L.trainingData)),trainingLabels:[].concat((0,r.Z)(g),(0,r.Z)(L.trainingLabels)),featuresToUse:M},console.log(f),D(f),p=new Z.q(f),e.next=22,p.trainPromise();case 22:se(p),console.log("finished train"),de();case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,l,c,s,u,m,d,g,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe(!1),n=new h.Z(t),_(n),r=new E.Z(t),e.next=6,r.getDataHandlerandStartingTrainingSet();case 6:return a=e.sent,i=a.data_provider,S(i),l=a.training_data.training_table,c=l.getDataColumnsPaired(),s=l.getTrainingLabels(),u=c.map((function(e){var t=e.objectnum,n=e.imagenum;return i.getRow("object_data",{ObjectNumber:t,ImageNumber:n})})),m=a.training_data.features,d=m.filter((function(e){return!e.includes("Location")&&"ObjectNumber"!==e&&"ImageNumber"!==e})),G(d),console.log("finished data initialization"),D(g={classifierType:"LogisticRegression",trainingData:u,trainingLabels:s,featuresToUse:d}),console.log("start initial train"),f=new Z.q(g),e.next=23,f.trainPromise();case 23:se(f),console.log("end initial train"),Q(!0),X(!0),re(!0),console.log("finished upload");case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:me(),ce.DownloadModelPromise().then(de);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function be(e){return{unclassified:e.map((function(e,t){return{id:t,address:e}})),positive:[],negative:[]}}return l.createElement("div",{style:{resize:"horizontal"}},l.createElement(c.Z,null,l.createElement(s.Z,null,l.createElement(v.Z,{src:p.Z,style:{marginRight:"40%",height:"90px"}})),l.createElement(s.Z,null,l.createElement(u.Z,{style:{color:"black",marginLeft:"50%"}}," ",l.createElement(b.Z,null)))),l.createElement(c.Z,null,l.createElement(m.Z,{container:!0,justify:"center",spacing:2,style:{marginBottom:15}},l.createElement(m.Z,{key:0,item:!0},l.createElement(d.Z,{disabled:!K,variant:"contained","aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){i(e.currentTarget)}},"Fetch"),l.createElement(g.Z,{id:"simple-menu",anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:ue},l.createElement(f.Z,{onClick:function(){return ue("random")}},"Random"),l.createElement(f.Z,{onClick:function(){return ue("positive")}},"Positive"),l.createElement(f.Z,{onClick:function(){return ue("negative")}},"Negative"))),l.createElement(m.Z,{key:1,item:!0},l.createElement(d.Z,{disabled:!W,variant:"contained",onClick:fe},"Train")),l.createElement(m.Z,{key:2,item:!0},l.createElement(d.Z,{disabled:!ee,variant:"contained",onClick:function(){}},"Evaluate")),l.createElement(m.Z,{key:3,item:!0},l.createElement(d.Z,{disabled:!ne,variant:"contained",onClick:ve},"Download")),l.createElement(m.Z,{key:4,item:!0},l.createElement(d.Z,{disabled:!ie,variant:"contained",component:"label",onClick:function(){return console.log("Upload!")}},"Upload",l.createElement("input",{type:"file",hidden:!0,webkitdirectory:"true",mozdirectory:"true",msdirectory:"true",odirectory:"true",directory:"true",multiple:!0,onChange:function(e){pe(e)}}))))),l.createElement(C.d,{onChange:function(e,t,n,r){var a;if(r){var i,o=(0,w.p)(T[e],T[r],t,n);return U(Object.assign({},T,((i={})[e]=o[0],i[r]=o[1],i)))}var l=(0,N.L)(T[e],t,n);return U(Object.assign({},T,((a={})[e]=l,a)))}},l.createElement("div",null,l.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"10%",marginBottom:.5}},"Unclassified"),l.createElement("div",{className:"topContainer"},l.createElement(P.$,{className:"dropzone ",id:"unclassified",boxesPerRow:8,rowHeight:70},T.unclassified.map((function(e){return l.createElement(x.P,{key:e.id},l.createElement("div",{className:"grid-item"},l.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}})))})))),l.createElement(c.Z,null,l.createElement("label",{style:{textAlign:"left",backgroundColor:"white",paddingLeft:"11%",userSelect:"none",marginBottom:"0.5%"}},"Positive"),l.createElement("label",{style:(e={textAlign:"left",backgroundColor:"white",paddingRight:"8%",marginBottom:0,userSelect:"none",margin:"auto"},e.marginBottom="0.5%",e)},"Negative")),l.createElement(c.Z,null,l.createElement(P.$,{className:"dropzone positive",id:"positive",boxesPerRow:4,rowHeight:70},T.positive.map((function(e){return l.createElement(x.P,{key:e.id},l.createElement("div",{className:"grid-item"},l.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}})))}))),l.createElement(P.$,{className:"dropzone negative",id:"negative",boxesPerRow:4,rowHeight:70},T.negative.map((function(e){return l.createElement(x.P,{key:e.id},l.createElement("div",{className:"grid-item"},l.createElement("div",{className:"grid-item-content",style:{backgroundImage:"url("+e.address+")"}})))})))))))}}}]);
//# sourceMappingURL=component---src-pages-index-js-0ae0a21bad3474d756fa.js.map